# V3.1 Core Edition - ν†µν•© μ™„λ£

## π‰ V3.1 μ—”μ§„ ν†µν•© μ™„λ£ (2025-01-10)

### κµ¬ν„λ κΈ°λ¥

#### Phase 1: μ„λΉ„μ¤ λ μ΄μ–΄ β…
- **ExplanationService**: μΈκ³Ό κµ¬μ΅° μ„¤λ… μƒμ„± (Input β†’ Needs β†’ Resolution β†’ Action)
- **ResultFormatter**: V3.1 κ²°κ³Όλ¥Ό UI νΈν™ ν•μ‹μΌλ΅ λ³€ν™
- ν…μ¤νΈ: 6/6 ν†µκ³Ό

#### Phase 2: API μ—”λ“ν¬μΈνΈ β…
- **`/api/analyze/v31`**: V3.1 Core μ „μ© API
- TraitEngine β†’ NeedsEngine β†’ ResolutionEngine β†’ ActionEngine ν†µν•©
- λ²”μ„ κ²€μ¦ (20-34ν‰ μ•„ννΈ)
- Fallback μ²λ¦¬

#### Phase 3: UI μ—°κ²° β…
- **`ai-recommendation/page.tsx`** V3.1 κ²°κ³Ό ν‘μ‹
  - Needs μΉ΄λ“ (HIGH λ λ²¨ μ°μ„  ν‘μ‹)
  - μΈκ³Ό κµ¬μ΅° μ„¤λ… (4λ‹¨κ³„)
  - ν•„μ/κ¶μ¥ κ³µμ • κµ¬λ¶„
  - κ΄€λ ¨ Needs ν‘μ‹

### V3.1 μ—”μ§„ κµ¬μ΅°

```
Input Layer (Soft + Hard + Budget + Rooms)
    β†“
Needs Layer (6κ° Core Needs)
    β”β”€ μ•μ „μ„± κ°•ν™”
    β”β”€ μλ‚© κ°•ν™”
    β”β”€ λ™μ„  μµμ ν™”
    β”β”€ λ‚΄κµ¬μ„± κ°•ν™”
    β”β”€ μ²­μ†/κ΄€λ¦¬ νΈμμ„±
    β””β”€ μ±„κ΄‘Β·λ°κΈ° ν–¥μƒ
    β†“
Resolution Layer (μ¶©λ ν•΄κ²°)
    β†“
Action Layer (κ³µμ •/μµμ… μ¶”μ²)
    β†“
Explanation Layer (μΈκ³Ό κµ¬μ΅° μ„¤λ…)
    β†“
UI (ResultFormatter)
```

### Core Edition λ²”μ„
- **ν‰μ**: 20-34ν‰
- **μ£Όκ±°ν•νƒ**: μ•„ννΈ
- **μƒνƒ**: κ±°μ£Ό μ¤‘
- **κ³µκ°„**: μ•μ‹¤, μ£Όλ°©, κ±°μ‹¤ μ¤‘μ‹¬

### API μ‚¬μ©λ²•

```typescript
// POST /api/analyze/v31
{
  spaceInfo: {
    pyeong: 25,
    housingType: 'apartment',
    totalPeople: 3,
    // ...
  },
  selectedSpaces: ['bathroom', 'kitchen', 'living'],
  personality: {
    answers: { ... }
  }
}
```

### μ‘λ‹µ ν•μ‹

```typescript
{
  success: true,
  engine: 'v3.1-core',
  result: {
    summary: { title, description },
    needs: [
      {
        id: 'safety',
        name: 'μ•μ „μ„± κ°•ν™”',
        level: 'high',
        reason: 'μμ μ•„κ°€ μμ–΄ λ―Έλ„λΌ λ°©μ§€...',
        priority: 1
      }
    ],
    processes: [
      {
        name: 'μ•μ‹¤ λ°”λ‹¥ νƒ€μΌ',
        priority: 'must',
        reason: '...',
        relatedNeeds: ['safety']
      }
    ],
    explanation: {
      segments: [
        { order: 1, title: 'κ³ κ°λ‹μ μƒν™©', content: '...' },
        { order: 2, title: 'ν•µμ‹¬ λ‹μ¦ λ¶„μ„', content: '...' },
        { order: 3, title: 'μ¶”μ² κ³µμ •', content: '...' }
      ]
    }
  }
}
```

### νμΌ κµ¬μ΅°

```
lib/analysis/engine-v3.1-core/
β”β”€β”€ types/
β”‚   β”β”€β”€ input.ts
β”‚   β”β”€β”€ needs.ts
β”‚   β”β”€β”€ resolution.ts
β”‚   β””β”€β”€ action.ts
β”β”€β”€ engines/
β”‚   β”β”€β”€ InputAdapter.ts
β”‚   β”β”€β”€ NeedsEngineCore.ts
β”‚   β”β”€β”€ ResolutionEngine.ts
β”‚   β””β”€β”€ ActionEngine.ts
β”β”€β”€ services/
β”‚   β”β”€β”€ ExplanationService.ts
β”‚   β””β”€β”€ ResultFormatter.ts
β”β”€β”€ config/
β”‚   β”β”€β”€ scope.ts
β”‚   β”β”€β”€ needs-definitions.ts
β”‚   β”β”€β”€ mapping-rules.ts
β”‚   β””β”€β”€ process-mapping.ts
β””β”€β”€ index.ts

app/api/analyze/v31/
β””β”€β”€ route.ts

app/onboarding/ai-recommendation/
β””β”€β”€ page.tsx (V3.1 UI ν†µν•©)
```

### ν…μ¤νΈ

```bash
# Phase 1 ν…μ¤νΈ
npx tsx lib/analysis/engine-v3.1-core/test-phase1.ts

# API ν…μ¤νΈ (μ„λ²„ μ‹¤ν–‰ ν›„)
npx tsx scripts/test-v31-api.ts
```

### λ‹¤μ λ‹¨κ³„

1. **μ‹¤μ  μ‚¬μ©μ ν…μ¤νΈ**
   - λ‹¤μ–‘ν• ν‰μ/μ„±ν–¥ μ΅°ν•© ν…μ¤νΈ
   - Needs λ„μ¶ μ •ν™•λ„ κ²€μ¦
   - κ³µμ • μ¶”μ² μ μ •μ„± ν™•μΈ

2. **ν™•μ¥ κ°€λ¥μ„±**
   - Extended Edition (40ν‰ μ΄μƒ)
   - Villa Edition (λΉλΌ/λ‹¤μ„Έλ€)
   - μ¶”κ°€ Needs μ •μ

3. **μµμ ν™”**
   - Needs λ§¤ν•‘ λ£° κ°μ„ 
   - Resolution λ΅μ§ μ •κµν™”
   - Explanation ν’μ§ ν–¥μƒ

### κΈ°μ  λ¶€μ±„ / κ°μ„  μ‚¬ν•­

- [ ] λ κ±°μ‹ V2 μ—”μ§„ μ κ±° κ²€ν† 
- [ ] Needs λ§¤ν•‘ λ£° λ°μ΄ν„°λ² μ΄μ¤ν™”
- [ ] κ³µμ • λ§¤ν•‘ ν™•μ¥ (ν„μ¬ 6κ° β†’ 12κ° μ΄μƒ)
- [ ] ν…μ¤νΈ μΌ€μ΄μ¤ 20κ° μ‘μ„±
- [ ] μ„±λ¥ μµμ ν™” (ν„μ¬ ~10ms)

### μ£Όμ” μ°¨μ΄μ : V2 vs V3.1

| ν•­λ© | V2 | V3.1 Core |
|------|----|----|
| κµ¬μ΅° | Input β†’ Action μ§μ ‘ | Input β†’ Needs β†’ Action |
| μ„¤λ… | κ°μ„±μ  | μΈκ³Ό κµ¬μ΅° |
| μ°μ„ μμ„ | μ μ κΈ°λ° | μΉ΄ν…κ³ λ¦¬ κΈ°λ° (μ•μ „>μƒν™>κ°μ„±) |
| ν™•μ¥μ„± | λ‚®μ | λ†’μ |
| λ²”μ„ | μ „μ²΄ | 20-34ν‰ μ•„ννΈ |
| Needs | μ—†μ | 6κ° Core |
| Resolution | μ—†μ | μ¶©λ ν•΄κ²° |

---

## μ™„λ£ λ‚ μ§
2025-01-10

## λ‹΄λ‹Ή
μΈν…λ¦¬λ΄‡ V3.1 Core Edition ν†µν•© ν”„λ΅μ νΈ




















