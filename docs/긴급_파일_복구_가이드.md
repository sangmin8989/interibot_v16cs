# 🚨 긴급 파일 복구 가이드

**발생 시간**: 2025년 12월  
**문제**: PowerShell 명령어 실행 중 파일 손상 발생

---

## 손상된 파일

1. `lib/estimate/constitution-v1-engine.ts` - 12바이트 (손상)
2. `app/api/estimate/constitution/route.ts` - 손상 확인 필요

---

## 즉시 복구 방법

### 방법 1: Cursor IDE Undo (가장 빠름) ⭐

1. **constitution-v1-engine.ts 복구**:
   - Cursor에서 `lib/estimate/constitution-v1-engine.ts` 파일 열기
   - `Ctrl + Z` (또는 `Cmd + Z`)를 **여러 번** 눌러서 이전 상태로 되돌리기
   - 파일이 정상적으로 보일 때까지 Undo 실행

2. **route.ts 복구**:
   - Cursor에서 `app/api/estimate/constitution/route.ts` 파일 열기
   - `Ctrl + Z`를 여러 번 눌러서 이전 상태로 되돌리기

### 방법 2: Cursor Local History

1. 파일 우클릭 → "Local History" 또는 "Timeline" 선택
2. 이전 버전 선택하여 복구

### 방법 3: 파일 닫기 후 다시 열기

1. 손상된 파일 모두 닫기
2. Cursor 재시작
3. 파일 다시 열기 (자동 저장된 버전이 있을 수 있음)

---

## 복구 후 확인 사항

복구 후 다음을 확인하세요:

1. **파일 크기 확인**:
   - `constitution-v1-engine.ts`: 약 3,000줄 이상이어야 함
   - `route.ts`: 약 200줄 이상이어야 함

2. **import 문 확인**:
   ```typescript
   // constitution-v1-engine.ts에 있어야 함
   import { getMaterialPriceStrict } from '@/lib/services/material-service-strict'
   import { getLaborRateStrict } from '@/lib/services/labor-service-strict'
   ```

3. **함수 확인**:
   - `calculateFinalEstimateV1` 함수 존재 확인
   - `createProcessBlocksWithDB` 함수 존재 확인

---

## 복구 실패 시

파일을 복구할 수 없는 경우:

1. **다른 소스 확인**:
   - 다른 브랜치에 파일이 있는지 확인
   - 협업자가 파일을 가지고 있는지 확인
   - 클라우드 백업 확인

2. **부분 복구**:
   - 헌법 v1.1 전용 서비스는 정상 작동 중
   - API 라우트만 부분 복구 가능
   - 엔진 파일은 전체 재작성 필요

---

## 예방 조치

앞으로는:
- 파일 수정 전 백업 생성
- git에 파일 추가하여 추적
- 대량 파일 수정 시 단계별 실행

---

**즉시 조치**: Cursor IDE에서 `Ctrl + Z`를 눌러 파일을 복구하세요!




