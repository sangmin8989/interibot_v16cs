# 성향 분석 결과 화면 전환 최종 3가지 명세서 비교 분석 보고서

## 📋 개요

인테리봇의 성향 분석 결과 화면(`app/onboarding/ai-recommendation/page.tsx`)을 "추천형 설명 UI"에서 "결정 정리형 UI"로 전환하는 작업에 대한 최종 3가지 명세서를 비교 분석한 보고서입니다.

---

## 🎯 명세서 비교 매트릭스

| 항목 | 명세서 1 | 명세서 2 | 명세서 3 |
|------|---------|---------|---------|
| **구조** | 7단계 | Phase 1(헬퍼) + Phase 2(UI) | Phase 1-7 |
| **헬퍼 함수 명시** | ❌ 없음 | ✅ Phase 1로 분리 | ❌ 없음 |
| **구체적 함수 시그니처** | ❌ 없음 | ✅ 제공 | ❌ 없음 |
| **전체 공정 카테고리 정의** | ❌ 언급만 | ✅ 상수 정의 명시 | ❌ 언급만 |
| **priority 값** | 'must', 'recommended' | 'must', 'recommended' | 'essential', 'recommended' |
| **섹션 제목** | "남은 선택" | "남은 선택" | "정리된 선택" |
| **process.reason 처리** | ❌ 명시 없음 | ✅ 직접 노출 금지 | ✅ 직접 노출 금지 |
| **API 응답 구조 제약** | ❌ 명시 없음 | ❌ 명시 없음 | ✅ 명시적 금지 |

---

## 📊 단계별 상세 비교

### [1단계/Phase 1] 상단 헤더 문구 교체

#### 명세서 1
```
제목:
"이번 조건에서는
{집중 카테고리} 외 공정은
검토하지 않도록 정리했습니다."

부제:
"구조·설비 공사는 이번 분석에서 제외되었습니다."

※ {집중 카테고리}는
analysisResult.needs 또는 processes에서
가장 우선순위 높은 카테고리로 계산한다.
```

#### 명세서 2
```
이번 조건에서는
{getFocusedCategory(result)} 외 공정은
검토하지 않도록 정리했습니다.

보조 문구:
구조·설비 공사는 이번 분석에서 제외되었습니다.
```

#### 명세서 3
```
표시 문구:
"이번 조건에서는
{집중 카테고리} 외 공정은 검토하지 않도록 정리했습니다."

보조 문구:
"구조·설비 공사는 이번 분석에서 제외되었습니다."

※ 집중 카테고리는
analysisResult.needs 또는 processes 기반으로
클라이언트에서 계산한다.
```

**비교 결과**: ✅ 3개 명세서 모두 동일한 문구, 명세서 1과 3이 계산 방법 명시

---

### [2단계/Phase 2] V3 분석 카드 문구 수정

#### 명세서 1
```
"OO평 · OO가구 기준
'{집중 카테고리}만 집중' 판단 결과입니다."

설명 문구:
"이번 분석은 생활 불편 요소 중
{집중 카테고리} 문제만 해결하도록
범위를 제한했습니다."
```

#### 명세서 2
```
타이틀:
{평수}평 · {가구수} 기준
'{getFocusedCategory(result)}만 집중' 판단 결과입니다.

설명:
이번 분석은 생활 불편 요소 중
{getFocusedCategory(result)} 문제만 해결하도록
범위를 제한했습니다.
```

#### 명세서 3
```
"OO평 · OO가구 기준
'{집중 카테고리}만 집중' 판단 결과입니다."

설명 문구:
"이번 분석은 생활 불편 요소 중
{집중 카테고리} 문제만 해결하도록 범위를 제한했습니다."

※ '맞춤', '추천' 단어 사용 금지
```

**비교 결과**: ✅ 3개 명세서 모두 동일, 명세서 3이 금지 단어 명시

---

### [3단계/Phase 3] '왜 이런 설계가 나왔나요?' 구조 개편

#### 명세서 1
```
[이번 분석에서 고려한 것]
- 가족 구성
- 생활 불편 요소
- 사용 빈도 높은 공간

[이번 분석에서 제외한 것]
- 구조 변경 공사
- 주방 리모델링
- 욕실 전체 교체

고정 문구:
"이번 분석에서는
필요하지 않은 공사를 먼저 제외했습니다."

[그래서 남은 선택]
- priority === 'must' → "필수 선택"
- priority === 'recommended' → "선택 가능"
```

#### 명세서 2
```
[이번 분석에서 고려한 것]
- 가족 구성
- {getFocusedCategory(result)} 문제
- 사용 빈도 높은 공간

[이번 분석에서 제외한 것]
- 구조 변경 공사
- 주방 리모델링
- 욕실 전체 교체

고정 문구:
이번 분석에서는
필요하지 않은 공사를 먼저 제외했습니다.

[그래서 남은 선택]
- 필수 공정: priority === 'must'
- 선택 공정: priority === 'recommended'
```

#### 명세서 3
```
1. 이번 분석에서 고려한 것
- 가족 구성
- 주요 니즈 (analysisResult.needs 기반)
- 사용 빈도 높은 공간

2. 이번 분석에서 제외한 것
- 구조 변경 공사
- 주방 리모델링
- 욕실 전체 교체

고정 문구:
"이번 분석에서는
필요하지 않은 공사를 먼저 제외했습니다."

3. 그래서 남은 선택
- 필수 공정 (priority === 'essential')
- 선택 가능 공정 (priority === 'recommended')
```

**비교 결과**: 
- 구조는 동일 ✅
- priority 값 차이: 명세서 1,2는 'must', 명세서 3은 'essential' ⚠️
- 명세서 2가 집중 카테고리를 동적으로 표시
- 명세서 3이 "주요 니즈 (analysisResult.needs 기반)" 명시

---

### [4단계/Phase 4] AI 판단 요약 박스 추가

#### 명세서 1
```
위치: 추천 공정 섹션 바로 위

제목: "🧠 인테리봇 판단 요약"

표시 방식:
- 전체 공정 카테고리 목록을 기준으로
- 포함된 공정은 ⭕
- 제외된 공정은 ❌ 로 표시

하단 고정 문구:
"이번 조건에서는
위 공정들을 검토하지 않아도 충분합니다."
```

#### 명세서 2
```
위치: 추천 공정 영역 상단

제목: 🧠 인테리봇 판단 요약

ALL_PROCESS_CATEGORIES를 기준으로
각 항목에 ⭕ / ❌ 표시

하단 고정 문구:
이번 조건에서는
위 공정들을 검토하지 않아도 충분합니다.
```

#### 명세서 3
```
위치: 추천 공정 리스트 상단

제목: "🧠 인테리봇 판단 요약"

내용:
- 전체 공정 카테고리 목록을 기준으로
  포함 ⭕ / 제외 ❌ 를 표시한다.

하단 고정 문구:
"이번 조건에서는
위 공정들을 검토하지 않아도 충분합니다."

※ 전체 공정 카테고리는
클라이언트 상수로 정의하고
analysisResult.processes와 비교한다.
```

**비교 결과**: ✅ 3개 명세서 모두 동일, 명세서 2와 3이 구현 방법 명시

---

### [5단계/Phase 5] 제외된 공정 접힘 영역 추가

#### 명세서 1
```
<details> 태그 또는 동일한 접힘 UI 사용

제목: "이번 분석에서 제외한 공정"

내용:
- 전체 공정 카테고리 목록
- analysisResult.processes에 없는 항목만 표시

하단 문구:
"필요해지면 이후 단계에서 다시 선택할 수 있습니다."
```

#### 명세서 2
```
제목: 이번 분석에서 제외한 공정

내용:
getExcludedProcesses(result) 결과 리스트 렌더링

하단 문구:
필요해지면 이후 단계에서 다시 선택할 수 있습니다.
```

#### 명세서 3
```
제목: "이번 분석에서 제외한 공정"

내용:
- 전체 공정 목록 – 선택된 공정
- 접힘(details) UI로 구현

하단 문구:
"필요해지면 이후 단계에서 다시 선택할 수 있습니다."
```

**비교 결과**: ✅ 3개 명세서 모두 동일, 명세서 2가 함수 호출 명시

---

### [6단계/Phase 6] 추천 공정 문구 수정

#### 명세서 1
```
섹션 제목: "남은 선택"

소제목:
- 필수 선택
- 선택 가능

공정 설명 문구:
"이 공정은
이번 조건에서 가장 효과가 확실한 선택입니다."

보조 문구:
"다른 공정 없이도 체감 변화가 큽니다."
```

#### 명세서 2
```
제목:
추천 공정 ❌ → 남은 선택 ⭕

소제목:
필수 공정 ❌ → 필수 선택 ⭕
권장 공정 ❌ → 선택 가능 ⭕

공정 설명 문구:
"{공정명}은
이번 조건에서 가장 효과가 확실한 선택입니다."

보조 문구:
다른 공정 없이도 체감 변화가 큽니다.

process.reason 직접 노출 금지
```

#### 명세서 3
```
기존:
- "추천 공정"
- "권장 공정"

변경:
- "정리된 선택"
- "필수 선택 / 선택 가능"

공정 설명 문구:
"{공정명}은
이번 조건에서 가장 효과가 확실한 선택입니다."

보조 문구:
"다른 공정 없이도 체감 변화가 큽니다."

※ process.reason 그대로 노출 금지
※ 추천·권장·제안 표현 전면 금지
```

**비교 결과**: 
- 섹션 제목 차이: 명세서 1,2는 "남은 선택", 명세서 3은 "정리된 선택" ⚠️
- 명세서 2와 3이 `process.reason` 직접 노출 금지 명시 ✅
- 명세서 2가 변경 전후 대비 명시

---

### [7단계/Phase 7] 금지 표현 제거

#### 명세서 1
```
다음 문자열을 전역 검색 후 제거 또는 대체한다.
- 추천
- 권장
- 제안
- 맞춤 설계
- 추천되었습니다
```

#### 명세서 2
```
다음 단어 전부 제거 또는 치환:
- 추천
- 권장
- 제안
- 맞춤 설계
- 추천되었습니다
```

#### 명세서 3
```
다음 문자열을 전역 검색 후 제거 또는 대체한다.

- 추천
- 권장
- 제안
- 맞춤 설계
- 추천되었습니다
- 최종 추천 공정
```

**비교 결과**: ✅ 거의 동일, 명세서 3이 "최종 추천 공정" 추가

---

## 🔧 헬퍼 함수 구현 비교

### 명세서 1
- ❌ 헬퍼 함수 구현에 대한 언급 없음
- 집중 카테고리 계산 방법만 간단히 명시

### 명세서 2
- ✅ **Phase 1로 헬퍼 함수 구현을 명시적으로 분리**
- ✅ 구체적인 함수 시그니처 제공:
  ```typescript
  const ALL_PROCESS_CATEGORIES = [...]
  function getFocusedCategory(result) {...}
  function getExcludedProcesses(result) {...}
  function isProcessIncluded(category, processes) {...}
  ```
- ✅ 전체 공정 카테고리 상수 정의 명시

### 명세서 3
- ❌ 헬퍼 함수 구현에 대한 언급 없음
- 계산 방법만 간단히 명시

**비교 결과**: 명세서 2가 가장 구체적이고 구현 가능한 형태로 제공

---

## ⚠️ 주요 차이점 및 해결 방안

### 차이점 1: priority 값 불일치

| 명세서 | 필수 공정 priority 값 |
|--------|---------------------|
| 명세서 1 | `'must'` |
| 명세서 2 | `'must'` |
| 명세서 3 | `'essential'` |

**현재 API 응답 확인 필요**: `app/onboarding/ai-recommendation/page.tsx:49`에서 `priority: 'must' | 'recommended' | 'optional'`로 정의되어 있음

**권장**: 현재 코드 기준으로 `'must'` 사용 (명세서 1, 2와 일치)

---

### 차이점 2: 섹션 제목 용어

| 명세서 | 추천 공정 섹션 제목 |
|--------|-------------------|
| 명세서 1 | "남은 선택" |
| 명세서 2 | "남은 선택" |
| 명세서 3 | "정리된 선택" |

**권장**: "남은 선택" 사용 (명세서 1, 2와 일치, 더 직관적)

---

### 차이점 3: 헬퍼 함수 구현 명시성

| 명세서 | 헬퍼 함수 명시 |
|--------|--------------|
| 명세서 1 | ❌ 없음 |
| 명세서 2 | ✅ Phase 1로 분리, 구체적 시그니처 제공 |
| 명세서 3 | ❌ 없음 |

**권장**: 명세서 2의 Phase 1 구조 채택 (구현 순서 명확)

---

## 🏆 통합 권장 명세서

### 핵심 원칙 (3개 명세서 공통)
- ✅ AI 로직, 계산 로직, LOCK 로직 절대 수정 금지
- ✅ 디자인, 색상, 레이아웃 변경 금지
- ✅ UI 문구와 정보 구조만 수정

### 구현 구조 (명세서 2 기반)

#### Phase 1: 헬퍼 함수 구현 (명세서 2 채택)

```typescript
// 전체 공정 카테고리 상수 정의
const ALL_PROCESS_CATEGORIES = [
  '구조 변경',
  '주방 리모델링',
  '욕실 전체 공사',
  '수납 강화',
  '마감 교체',
  '전기 증설 공사'
]

// 집중 카테고리 추출
function getFocusedCategory(result: V31AnalysisResult): string {
  const highNeed = result.needs?.find(n => n.level === 'high')
  return highNeed?.name || '수납'
}

// 제외된 공정 계산
function getExcludedProcesses(result: V31AnalysisResult): string[] {
  const included = result.processes.map(p => p.category || p.name)
  return ALL_PROCESS_CATEGORIES.filter(cat => 
    !included.some(inc => inc.includes(cat) || cat.includes(inc))
  )
}

// 공정 포함 여부 판단
function isProcessIncluded(category: string, processes: Process[]): boolean {
  return processes.some(p => 
    p.category === category || 
    p.name.includes(category) ||
    category.includes(p.name)
  )
}
```

#### Phase 2: UI 문구 및 구조 변경

**1단계: 상단 헤더 문구 교체**
- 기존 "AI 분석 완료" 제거
- `{getFocusedCategory(result)} 외 공정은 검토하지 않도록 정리했습니다.`
- 보조: "구조·설비 공사는 이번 분석에서 제외되었습니다."

**2단계: V3 분석 카드 문구 수정**
- `{평수}평 · {가구수} 기준 '{getFocusedCategory(result)}만 집중' 판단 결과입니다.`
- 설명: `이번 분석은 생활 불편 요소 중 {getFocusedCategory(result)} 문제만 해결하도록 범위를 제한했습니다.`

**3단계: '왜 이런 설계가 나왔나요?' 구조 개편**
- 기존 `explanation.segments` 반복 렌더링 제거
- 3단 구조로 고정 렌더링:
  1. 이번 분석에서 고려한 것
  2. 이번 분석에서 제외한 것 (고정 문구 포함)
  3. 그래서 남은 선택

**4단계: AI 판단 요약 박스 추가**
- 위치: 추천 공정 섹션 상단
- `ALL_PROCESS_CATEGORIES` 기준으로 ⭕/❌ 표시
- 하단: "이번 조건에서는 위 공정들을 검토하지 않아도 충분합니다."

**5단계: 제외된 공정 접힘 영역 추가**
- `<details>` 태그 사용
- `getExcludedProcesses(result)` 결과 표시
- 하단: "필요해지면 이후 단계에서 다시 선택할 수 있습니다."

**6단계: 추천 공정 문구 수정**
- "추천 공정" → "남은 선택"
- "필수 공정" → "필수 선택"
- "권장 공정" → "선택 가능"
- `process.reason` 직접 노출 금지, 고정 문구 사용

**7단계: 금지 표현 전역 제거**
- "추천", "권장", "제안", "맞춤 설계", "추천되었습니다", "최종 추천 공정" 제거

---

## 📝 구현 체크리스트

### Phase 1: 헬퍼 함수 구현
- [ ] `ALL_PROCESS_CATEGORIES` 상수 정의
- [ ] `getFocusedCategory()` 함수 구현
- [ ] `getExcludedProcesses()` 함수 구현
- [ ] `isProcessIncluded()` 함수 구현

### Phase 2: UI 수정
- [ ] 1단계: 상단 헤더 문구 교체
- [ ] 2단계: V3 분석 카드 문구 수정
- [ ] 3단계: '왜 이런 설계가 나왔나요?' 구조 개편
- [ ] 4단계: AI 판단 요약 박스 추가
- [ ] 5단계: 제외된 공정 접힘 영역 추가
- [ ] 6단계: 추천 공정 문구 수정
- [ ] 7단계: 금지 표현 전역 제거

### 검증
- [ ] 금지 표현 검색 및 제거 확인
- [ ] priority 값 확인 ('must' 사용)
- [ ] 섹션 제목 확인 ("남은 선택" 사용)
- [ ] `process.reason` 직접 노출 금지 확인

---

## ✅ 완료 기준 (3개 명세서 공통)

1. **"이건 안 해도 되는구나" 즉시 이해**
   - 제외된 공정이 화면에 명확히 표시되는가?
   - "검토하지 않아도 충분합니다" 메시지가 보이는가?

2. **'추천'보다 '제외'가 먼저 인식**
   - AI 판단 요약 박스가 추천 공정보다 위에 위치하는가?
   - 제외된 공정 목록이 접힘 영역으로 표시되는가?

3. **"판단을 정리해주는 AI"로 인식**
   - "필요하지 않은 공사를 먼저 제외했습니다" 문구가 있는가?
   - 설명 구조가 "제외한 것" → "고려한 것" → "남은 선택" 순서인가?

---

## 🎯 최종 권장사항

### 통합 명세서 사용
- **구조**: 명세서 2의 Phase 1(헬퍼) + Phase 2(UI) 구조 채택
- **헬퍼 함수**: 명세서 2의 구체적 시그니처 사용
- **문구**: 명세서 1, 2의 "남은 선택" 사용
- **priority 값**: 현재 코드 기준 `'must'` 사용
- **제약사항**: 명세서 3의 "API 응답 구조 변경 금지" 명시

### 구현 순서
1. **Phase 1**: 헬퍼 함수 구현 (명세서 2 기반)
2. **Phase 2**: UI 문구 및 구조 변경 (1-7단계 순차 진행)
3. **검증**: 금지 표현 제거 확인 및 완료 기준 검증

### 주의사항
- `priority` 값은 현재 코드 기준 `'must'` 사용
- `process.reason` 직접 노출 금지, 고정 문구 사용
- 전체 공정 카테고리는 클라이언트 상수로 정의
- API 응답 구조는 변경하지 않음

---

**작성일**: 2024년
**작성자**: AI Assistant
**버전**: 2.0 (최종)












