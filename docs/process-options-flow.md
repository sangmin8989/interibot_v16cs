# 공정별 세부 옵션 선택 기능

## 개요

성향 분석 완료 후 사용자가 원하는 공정을 선택하고, 각 공정에 맞는 세부 옵션을 입력받아 더 정확한 견적을 제공하는 기능입니다.

## 사용자 흐름

```
1. 성향 분석 완료 (/result)
   ↓
2. "공정 선택 & 견적" 버튼 클릭
   ↓
3. 공정 선택 페이지 (/process-select)
   - 전체 리모델링 또는 개별 공정 선택
   ↓
4. 세부 옵션 입력 (자동 표시)
   - 주방: 형태, 냉장고장, 키큰장 등
   - 욕실: 스타일, 욕조, 샤워부스 등
   - 목공: 가구 선택, 맞춤 제작 등
   ↓
5. "견적 확인하기" 버튼 클릭
   ↓
6. 견적 페이지 (/estimate)
   - 선택된 공정 및 옵션 표시
   - 4등급 견적 제공 (Basic/Standard/ARGEN/Premium)
```

## 주요 파일

### 1. 공정 선택 페이지
- **파일**: `app/process-select/page.tsx`
- **기능**: 
  - 공정 선택 (전체 리모델링 / 개별 공정)
  - 주방 옵션 입력 (형태, 추가 옵션)
  - URL 파라미터로 견적 페이지에 전달

### 2. 세부 옵션 페이지 (신규)
- **파일**: `app/process-options/page.tsx`
- **기능**:
  - 주방 옵션: 형태(일자/ㄱ자/ㄷ자/아일랜드), 냉장고장, 키큰장, 아일랜드장, 다용도실
  - 욕실 옵션: 스타일(모던/클래식/미니멀/내추럴), 욕조, 샤워부스, 비데, 수전업그레이드
  - 목공 옵션: 붙박이장, 신발장, TV장, 책장, 화장대, 책상, 맞춤제작

### 3. 견적 페이지
- **파일**: `app/estimate/page.tsx`
- **기능**:
  - URL 파라미터에서 옵션 추출
  - 견적 API에 옵션 전달
  - 선택된 공정 및 옵션 시각적 표시

### 4. 타입 정의
- **파일**: `lib/estimate/types.ts`
- **추가된 타입**:
  ```typescript
  export interface BathroomOptions {
    스타일?: BathroomStyle
    욕조?: boolean
    샤워부스?: boolean
    비데?: boolean
    수전업그레이드?: boolean
  }

  export interface WoodworkOptions {
    선택가구?: string[]
    맞춤제작?: boolean
  }
  ```

### 5. 견적 계산기
- **파일**: `lib/estimate/calculator.ts`
- **수정 사항**:
  - 욕실옵션, 목공옵션 파라미터 추가
  - 옵션에 따른 견적 계산 로직 (향후 확장 가능)

## URL 파라미터 구조

### 공정 선택 페이지로 이동
```
/process-select?analysisId=xxx&size=43&roomCount=3&bathroomCount=2
```

### 견적 페이지로 이동
```
/estimate?
  analysisId=xxx
  &selectedProcesses=주방,욕실,목공
  &size=43
  &roomCount=3
  &bathroomCount=2
  &kitchenLayout=ㄱ자
  &kitchenRefrigerator=true
  &kitchenTallCabinet=true
  &bathroomStyle=모던
  &bathroomBathtub=true
  &bathroomShowerBooth=true
  &woodworkFurniture=closet,shoeCabinet
  &woodworkCustom=true
```

## API 요청 구조

### 견적 계산 API 요청
```typescript
POST /api/estimate/calculate

{
  "평수": 43,
  "방개수": 3,
  "욕실개수": 2,
  "현재상태": "구축아파트",
  "성향": {
    "요리빈도": 4,
    "정리정돈": 3,
    "청소성향": 3,
    "조명취향": 4,
    "예산감각": 3
  },
  "selectedProcesses": ["주방", "욕실", "목공"],
  "주방옵션": {
    "형태": "ㄱ자",
    "냉장고장": true,
    "키큰장": true,
    "아일랜드장": false,
    "다용도실": false
  },
  "욕실옵션": {
    "스타일": "모던",
    "욕조": true,
    "샤워부스": true,
    "비데": false,
    "수전업그레이드": true
  },
  "목공옵션": {
    "선택가구": ["closet", "shoeCabinet"],
    "맞춤제작": true
  }
}
```

## 향후 확장 가능성

### 1. 견적 계산 로직 개선
현재는 옵션을 받아서 전달만 하지만, 향후 다음과 같이 확장 가능:
- 주방 형태에 따른 자재비/노무비 조정
- 욕실 스타일에 따른 브랜드 자동 선택
- 목공 가구 개수에 따른 수량 자동 계산
- 맞춤 제작 선택 시 프리미엄 가격 적용

### 2. 추가 공정 옵션
- **타일**: 타일 종류(도기질/포세린/대리석), 패턴
- **도배**: 벽지 종류(실크/합지/실크), 패턴
- **전기**: 콘센트 추가, 스마트홈 시스템
- **창호**: 창문 종류(PVC/알루미늄), 방음 등급

### 3. AI 추천 기능
성향 분석 결과를 바탕으로:
- 추천 주방 형태 제안
- 추천 욕실 스타일 제안
- 추천 목공 가구 제안

### 4. 시각화
- 선택한 옵션에 따른 3D 미리보기
- 비교 견적 (옵션 있음 vs 없음)
- 옵션별 가격 영향도 표시

## 테스트 시나리오

### 시나리오 1: 주방 리모델링
1. 성향 분석 완료
2. "주방" 공정 선택
3. 주방 형태: ㄱ자형 선택
4. 냉장고장, 키큰장 체크
5. 견적 확인 → 주방 옵션이 반영된 견적 표시

### 시나리오 2: 전체 리모델링
1. 성향 분석 완료
2. "전체 리모델링" 선택
3. 주방, 욕실, 목공 옵션 모두 입력
4. 견적 확인 → 모든 옵션이 반영된 견적 표시

### 시나리오 3: 옵션 없이 진행
1. 성향 분석 완료
2. 공정 선택만 하고 세부 옵션 입력 안 함
3. 견적 확인 → 기본 견적 표시

## 주의사항

1. **필수 옵션 검증**: 주방 선택 시 형태는 필수
2. **URL 파라미터 길이**: 너무 많은 옵션 시 URL 길이 제한 고려
3. **브라우저 호환성**: 모든 브라우저에서 URL 파라미터 인코딩 확인
4. **성능**: 옵션이 많아질수록 계산 시간 증가 가능성

## 개발 완료 항목

✅ 공정 선택 페이지 (기존)  
✅ 세부 옵션 페이지 (신규)  
✅ 견적 페이지 옵션 표시  
✅ 타입 정의 추가  
✅ URL 파라미터 전달  
✅ 견적 API 연동  

## 개발 예정 항목

⏳ 옵션에 따른 견적 계산 로직  
⏳ AI 기반 옵션 추천  
⏳ 옵션 시각화 (3D 미리보기)  
⏳ 추가 공정 옵션 (타일, 도배, 전기 등)  











