# κ²¬μ  μ—”μ§„ ν†µν•© λ§μ΄κ·Έλ μ΄μ… κ³„ν

> **μ‘μ„±μΌ**: 2025-12-31  
> **λ©μ **: λ‹¤μ¤‘ κ²¬μ  μ—”μ§„μ„ λ‹¨μΌ μ—”μ§„μΌλ΅ ν†µν•©

---

## π“‹ ν„μ¬ μƒνƒ

### μ‚¬μ© μ¤‘μΈ μ—”μ§„

| μ—”μ§„ | νμΌ μ„μΉ | API μ—”λ“ν¬μΈνΈ | μƒνƒ |
|------|----------|---------------|------|
| **V4 μ—”μ§„** | `lib/estimate-v4/` | `/api/estimate/v4` | πΆ κ³µμ‹ (ν„μ¬ μ‚¬μ©) |
| ν—λ²• V1 μ—”μ§„ | `lib/estimate/constitution-v1-engine.ts` | `/api/estimate/constitution` | π΅ λ¶€λ¶„ μ‚¬μ© |

### λ κ±°μ‹ μ—”μ§„ (λ΄‰μΈ ν•„μ”)

| μ—”μ§„ | νμΌ μ„μΉ | API μ—”λ“ν¬μΈνΈ | μƒνƒ |
|------|----------|---------------|------|
| Calculator V3 | `lib/estimate/calculator-v3.ts` | `/api/estimate/v3` | π”΄ λ΄‰μΈλ¨ (410) |
| Unified Calculator | `lib/estimate/unified-calculator.ts` | - | π”΄ λ―Έμ‚¬μ© |
| Unified Calculator V2 | `lib/estimate/unified-calculator-v2.ts` | `/api/estimate/calculate` | π”΄ λ΄‰μΈλ¨ (410) |
| Rule Engine V0 | `lib/estimate/rule-engine-v0.ts` | `/api/estimate/rule-engine-v0` | π”΄ λ΄‰μΈλ¨ (410) |
| ν—λ²• κ²¬μ  μ—”μ§„ | `lib/estimate/constitution-estimate-engine.ts` | - | π”΄ λ―Έμ‚¬μ© |

---

## π― λ©ν‘

1. **V4 μ—”μ§„μ„ λ©”μΈ μ—”μ§„μΌλ΅ μ μ§€**
2. **ν—λ²• V1 μ—”μ§„μ ν•µμ‹¬ λ΅μ§μ„ V4μ— ν†µν•©**
3. **λ κ±°μ‹ μ—”μ§„ λ΄‰μΈ μ™„λ£**

---

## π“ ν†µν•© μ „λµ

### Phase 1: ν—λ²• V1 λ΅μ§ λ¶„μ„ λ° μ¶”μ¶

**μ‘μ—… λ‚΄μ©**:
1. `constitution-v1-engine.ts`μ ν•µμ‹¬ λ΅μ§ νμ•…
2. V4 μ—”μ§„κ³Όμ μ°¨μ΄μ  λ¶„μ„
3. ν†µν•© κ°€λ¥ν• λ¶€λ¶„ μ‹λ³„

**νμΌ**:
- `lib/estimate/constitution-v1-engine.ts` - λ¶„μ„ λ€μƒ
- `lib/estimate-v4/` - ν†µν•© λ€μƒ

---

### Phase 2: V4 μ—”μ§„μ— ν—λ²• V1 λ΅μ§ ν†µν•©

**μ‘μ—… λ‚΄μ©**:
1. ν—λ²• V1μ κ²€μ¦ λ΅μ§μ„ V4μ— ν†µν•©
2. μμ¬/λ…Έλ¬΄ μ΅°ν λ΅μ§ ν†µμΌ (μ΄λ―Έ `getMaterialPriceStrict`, `getLaborRateStrict` μ‚¬μ© μ¤‘)
3. μ—λ¬ μ²λ¦¬ ν†µμΌ

**μ£Όμμ‚¬ν•­**:
- κΈ°μ΅΄ V4 API μΈν„°νμ΄μ¤ μ μ§€
- ν•μ„ νΈν™μ„± λ³΄μ¥

---

### Phase 3: λ κ±°μ‹ μ—”μ§„ λ΄‰μΈ ν™•μΈ

**μ‘μ—… λ‚΄μ©**:
1. λ¨λ“  λ κ±°μ‹ APIκ°€ 410 μ‘λ‹µ λ°ν™ν•λ”μ§€ ν™•μΈ
2. λ‚΄λ¶€ νΈμ¶μ΄ μ—†λ”μ§€ ν™•μΈ
3. λ¬Έμ„ν™”

**ν™•μΈ λ€μƒ**:
- `/api/estimate/v3` - β… λ΄‰μΈλ¨
- `/api/estimate/calculate` - β… λ΄‰μΈλ¨
- `/api/estimate/rule-engine-v0` - β… λ΄‰μΈλ¨
- `/api/estimate/constitution` - β οΈ ν™•μΈ ν•„μ”

---

### Phase 4: μ½”λ“ μ •λ¦¬

**μ‘μ—… λ‚΄μ©**:
1. μ‚¬μ©λμ§€ μ•λ” λ κ±°μ‹ μ—”μ§„ νμΌ μ •λ¦¬
2. μμ΅΄μ„± μ κ±°
3. λ¬Έμ„ μ—…λ°μ΄νΈ

---

## π”§ κµ¬ν„ μ„Έλ¶€μ‚¬ν•­

### 1. ν—λ²• V1 β†’ V4 ν†µν•© ν¬μΈνΈ

#### κ²€μ¦ λ΅μ§
- ν—λ²• V1: `EstimateValidationError` throw
- V4: μ΄λ―Έ `EstimateValidationError` μ‚¬μ© μ¤‘ β…

#### μμ¬/λ…Έλ¬΄ μ΅°ν
- ν—λ²• V1: `getMaterialPriceStrict`, `getLaborRateStrict`
- V4: `CostCalculator`μ—μ„ λ™μΌν• μ„λΉ„μ¤ μ‚¬μ© β…

#### κ³µμ • μ²λ¦¬
- ν—λ²• V1: `processSelections` κΈ°λ°
- V4: `ProcessPicker` + `ProcessBlock` κΈ°λ°
- **ν†µν•© ν•„μ”**: V4μ `ProcessPicker`κ°€ ν—λ²• V1μ `processSelections` ν•μ‹λ„ μ§€μ›ν•λ„λ΅ ν™•μ¥

---

### 2. API ν†µν•© μ „λµ

**μµμ… A: V4 μ—”μ§„ ν™•μ¥ (κ¶μ¥)**
- V4 μ—”μ§„μ΄ ν—λ²• V1μ λ¨λ“  κΈ°λ¥ μ§€μ›
- `/api/estimate/v4`κ°€ λ‹¨μΌ μ—”λ“ν¬μΈνΈ
- ν—λ²• V1 APIλ” V4λ΅ λ¦¬λ‹¤μ΄λ ‰νΈ

**μµμ… B: ν—λ²• V1μ„ V4 λνΌλ΅ λ³€κ²½**
- ν—λ²• V1 APIλ” λ‚΄λ¶€μ μΌλ΅ V4 μ—”μ§„ νΈμ¶
- API μΈν„°νμ΄μ¤λ” μ μ§€

---

## β οΈ μ£Όμμ‚¬ν•­

1. **ν•μ„ νΈν™μ„±**
   - κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ κΉ¨μ§€μ§€ μ•λ„λ΅ μ£Όμ
   - API μ‘λ‹µ ν•μ‹ μ μ§€

2. **ν…μ¤νΈ**
   - ν†µν•© μ „ν›„ κ²¬μ  κ²°κ³Ό λΉ„κµ
   - λ¨λ“  κ³µμ • νƒ€μ… ν…μ¤νΈ

3. **μ μ§„μ  λ§μ΄κ·Έλ μ΄μ…**
   - ν• λ²μ— λ¨λ“  κ²ƒμ„ λ°”κΎΈμ§€ μ•μ
   - λ‹¨κ³„λ³„ κ²€μ¦

---

## π“ μ§„ν–‰ μƒν™©

- [ ] Phase 1: ν—λ²• V1 λ΅μ§ λ¶„μ„
- [ ] Phase 2: V4 μ—”μ§„ ν†µν•©
- [ ] Phase 3: λ κ±°μ‹ μ—”μ§„ λ΄‰μΈ ν™•μΈ
- [ ] Phase 4: μ½”λ“ μ •λ¦¬

---

## π“ μ°Έκ³  λ¬Έμ„

- `docs/V4_SPEC_PRICING_CALCULATION_REPORT.md` - V4 λ…μ„Έμ„
- `docs/ν—λ²•_v1.1_μµμΆ…_μ™„λ£_λ³΄κ³ μ„.md` - ν—λ²• V1 λ…μ„Έμ„
- `docs/μ „μ²΄_κ³µμ •_κ²¬μ _μ‹μ¤ν…_μΆ…ν•©_λ¶„μ„_λ³΄κ³ μ„.md` - μ „μ²΄ κµ¬μ΅°

---

**μ‘μ„± μ™„λ£** β…
